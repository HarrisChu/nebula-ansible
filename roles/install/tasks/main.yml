- name: create directory to store nebula package on all machines in the cluster
  file:
    path: "{{ packages_dir }}"
    state: directory
    mode: 0775

- include_vars: file={{ playbook_dir }}/conf/packages.yml

- name: copy nebula package from Control Machine to all machines in the cluster
  copy:
    src="{{ packages_dir }}/{{ item.filename }}"
    dest="{{ packages_dir }}/{{ item.filename }}"
  with_items: "{{  nebula_packages }}"

- name: install nebula package on all machines in the cluster
  package:
    name: "{{ packages_dir }}/{{ item.filename }}"
    state: present
  with_items: "{{ nebula_packages }}"
